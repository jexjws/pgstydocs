---
title: 参数
description: 使用 120 个参数定制 PostgreSQL 集群
icon: Variable
---

`PGSQL` 模块有 **120** 个参数。


| 章节                         | 数量 | 描述                                                                                                                                        |
|---------------------------------|-------|----------------------------------------------------------------------------------------------------------------------------------------------------|
| [`PG_ID`](#pg_id)               | 11    | 计算和检查 Postgres 身份 - 用于识别 PGSQL 实体（如实例和服务）的参数                                        |
| [`PG_BUSINESS`](#pg_business)   | 12    | Postgres 业务对象定义 - 业务用户、数据库、服务和身份验证的配置                                    |
| [`PG_INSTALL`](#pg_install)     | 10    | 安装 PGSQL 包和扩展 - 数据库用户设置、版本选择和包安装的设置                                |
| [`PG_BOOTSTRAP`](#pg_bootstrap) | 35    | 使用 Patroni 初始化 HA Postgres 集群 - 包括数据目录、网络和高可用性设置的全面集群初始化 |
| [`PG_PROVISION`](#pg_provision) | 9     | 创建用户、数据库和数据库内对象 - 引导后的数据库对象置备和默认配置                      |
| [`PG_BACKUP`](#pg_backup)       | 5     | 使用 pgbackrest 设置备份仓库 - 使用 pgbackrest 的备份和恢复配置                                                             |
| [`PG_ACCESS`](#pg_access)       | 16    | 暴露 pg 服务，绑定 VIP 和注册 DNS - 服务暴露、负载均衡、VIP 管理和 DNS 注册                            |
| [`PG_MONITOR`](#pg_exporter)    | 18    | 为 PGSQL 实例添加监控 - 使用各种导出器进行指标收集的监控设置                                                    |
| [`PG_REMOVE`](#pg_remove)       | 4     | 删除 Postgres 集群 - 带有数据清理选项的安全集群删除                                                                         |


## 参数 [#parameters]

[`PG_ID`](#pg_id)：计算和检查 Postgres 身份

| 名称                                    | 类型     | 级别 | 注释                                                           |
|-----------------------------------------|----------|-------|-------------------------------------------------------------------|
| [`pg_mode`](#pg_mode)                   | `enum`   | C     | pgsql 集群模式：pgsql,citus,mssql,polar,ivory,oracle,gpsql    |
| [`pg_cluster`](#pg_cluster)             | `string` | C     | pgsql 集群名称，必填身份参数                   |
| [`pg_seq`](#pg_seq)                     | `int`    | I     | pgsql 实例序号，必填身份参数            |
| [`pg_role`](#pg_role)                   | `enum`   | I     | pgsql 角色，必填，可以是 primary,replica,offline            |
| [`pg_instances`](#pg_instances)         | `dict`   | I     | 以 `{port:ins_vars}` 格式在节点上定义多个 pg 实例  |
| [`pg_upstream`](#pg_upstream)           | `ip`     | I     | 备用集群或级联副本的复制上游 IP 地址      |
| [`pg_shard`](#pg_shard)                 | `string` | C     | pgsql 分片名称，分片集群的可选身份         |
| [`pg_group`](#pg_group)                 | `int`    | C     | pgsql 分片索引号，分片集群的可选身份 |
| [`gp_role`](#gp_role)                   | `enum`   | C     | 此集群的 greenplum 角色，可以是 master 或 segment        |
| [`pg_exporters`](#pg_exporters)         | `dict`   | C     | 监控远程 postgres 实例的额外 pg_exporters      |
| [`pg_offline_query`](#pg_offline_query) | `bool`   | I     | 设置为 true 以在此实例上启用离线查询              |

[`PG_BUSINESS`](#pg_business)：Postgres 业务对象定义

| 名称                                                  | 类型         | 级别 | 注释                                                        |
|-------------------------------------------------------|--------------|-------|----------------------------------------------------------------|
| [`pg_users`](#pg_users)                               | `user[]`     | C     | postgres 业务用户                                        |
| [`pg_databases`](#pg_databases)                       | `database[]` | C     | postgres 业务数据库                                    |
| [`pg_services`](#pg_services)                         | `service[]`  | C     | postgres 业务服务                                     |
| [`pg_hba_rules`](#pg_hba_rules)                       | `hba[]`      | C     | postgres 的业务 hba 规则                                |
| [`pgb_hba_rules`](#pgb_hba_rules)                     | `hba[]`      | C     | pgbouncer 的业务 hba 规则                               |
| [`pg_replication_username`](#pg_replication_username) | `username`   | G     | postgres 复制用户名，默认为 `replicator`         |
| [`pg_replication_password`](#pg_replication_password) | `password`   | G     | postgres 复制密码，默认为 `DBUser.Replicator`  |
| [`pg_admin_username`](#pg_admin_username)             | `username`   | G     | postgres 管理员用户名，默认为 `dbuser_dba`               |
| [`pg_admin_password`](#pg_admin_password)             | `password`   | G     | postgres 管理员明文密码，默认为 `DBUser.DBA` |
| [`pg_monitor_username`](#pg_monitor_username)         | `username`   | G     | postgres 监控用户名，默认为 `dbuser_monitor`         |
| [`pg_monitor_password`](#pg_monitor_password)         | `password`   | G     | postgres 监控密码，默认为 `DBUser.Monitor`         |
| [`pg_dbsu_password`](#pg_dbsu_password)               | `password`   | G/C   | postgres dbsu 密码，默认为空字符串以禁用它     |

[`PG_INSTALL`](#pg_install)：安装 PGSQL 包和扩展

| 名称                                            | 类型       | 级别 | 注释                                                         |
|-------------------------------------------------|------------|-------|-----------------------------------------------------------------|
| [`pg_dbsu`](#pg_dbsu)                           | `username` | C     | 操作系统 dbsu 名称，默认为 postgres，最好不要更改         |
| [`pg_dbsu_uid`](#pg_dbsu_uid)                   | `int`      | C     | 操作系统 dbsu uid 和 gid，默认 postgres 用户和组为 26   |
| [`pg_dbsu_sudo`](#pg_dbsu_sudo)                 | `enum`     | C     | dbsu sudo 权限，none,limit,all,nopass。默认为 limit    |
| [`pg_dbsu_home`](#pg_dbsu_home)                 | `path`     | C     | postgresql 主目录，默认为 `/var/lib/pgsql`          |
| [`pg_dbsu_ssh_exchange`](#pg_dbsu_ssh_exchange) | `bool`     | C     | 在同一 pgsql 集群间交换 postgres dbsu ssh 密钥         |
| [`pg_version`](#pg_version)                     | `enum`     | C     | 要安装的 postgres 主版本，默认为 16           |
| [`pg_bin_dir`](#pg_bin_dir)                     | `path`     | C     | postgres 二进制目录，默认为 `/usr/pgsql/bin`                |
| [`pg_log_dir`](#pg_log_dir)                     | `path`     | C     | postgres 日志目录，默认为 `/pg/log/postgres`                 |
| [`pg_packages`](#pg_packages)                   | `string[]` | C     | 要安装的 pg 包，`${pg_version}` 将被替换   |
| [`pg_extensions`](#pg_extensions)               | `string[]` | C     | 要安装的 pg 扩展，`${pg_version}` 将被替换 |

[`PG_BOOTSTRAP`](#pg_bootstrap)：使用 Patroni 启动 HA Postgres 集群

| 名称                                                | 类型       | 级别 | 注释                                                                       |
|-----------------------------------------------------|------------|-------|-------------------------------------------------------------------------------|
| [`pg_data`](#pg_data)                               | `path`     | C     | postgres 数据目录，默认为 `/pg/data`                                |
| [`pg_fs_main`](#pg_fs_main)                         | `path`     | C     | postgres 备份数据目录，默认为 `/data/backups`                    |
| [`pg_fs_backup`](#pg_fs_backup)                     | `path`     | C     | pg 备份数据的挂载点/路径，默认为 `/data/backup`                 |
| [`pg_storage_type`](#pg_storage_type)               | `enum`     | C     | pg 主数据的存储类型，SSD,HDD，默认为 SSD                        |
| [`pg_dummy_filesize`](#pg_dummy_filesize)           | `size`     | C     | `/pg/dummy` 的大小，为紧急使用保留 64MB 磁盘空间                   |
| [`pg_listen`](#pg_listen)                           | `ip(s)`    | C/I   | postgres/pgbouncer 监听地址，逗号分隔列表                     |
| [`pg_port`](#pg_port)                               | `port`     | C     | postgres 监听端口，默认为 5432                                         |
| [`pg_localhost`](#pg_localhost)                     | `path`     | C     | postgres unix socket 目录，用于本地连接                             |
| [`pg_namespace`](#pg_namespace)                     | `path`     | C     | etcd 中的顶级键命名空间，由 patroni 和 vip 使用                        |
| [`patroni_enabled`](#patroni_enabled)               | `bool`     | C     | 如果禁用，初始化期间不会创建 postgres 集群                  |
| [`patroni_mode`](#patroni_mode)                     | `enum`     | C     | patroni 工作模式：default,pause,remove                                    |
| [`patroni_port`](#patroni_port)                     | `port`     | C     | patroni 监听端口，默认为 8008                                          |
| [`patroni_log_dir`](#patroni_log_dir)               | `path`     | C     | patroni 日志目录，默认为 `/pg/log/patroni`                                 |
| [`patroni_ssl_enabled`](#patroni_ssl_enabled)       | `bool`     | G     | 使用 SSL 保护 patroni RestAPI 通信？                               |
| [`patroni_watchdog_mode`](#patroni_watchdog_mode)   | `enum`     | C     | patroni 看门狗模式：automatic,required,off。默认为 off                 |
| [`patroni_username`](#patroni_username)             | `username` | C     | patroni restapi 用户名，默认为 `postgres`                               |
| [`patroni_password`](#patroni_password)             | `password` | C     | patroni restapi 密码，默认为 `Patroni.API`                            |
| [`pg_primary_db`](#pg_primary_db)                   | `string`   | C     | 主数据库名称，由 citus 等使用，默认为 postgres                |
| [`pg_parameters`](#pg_parameters)                   | `dict`     | C     | postgresql.auto.conf 中的额外参数                                      |
| [`pg_files`](#pg_files)                             | `path[]`   | C     | 要复制到 postgres 数据目录的额外文件（例如许可证）            |
| [`pg_conf`](#pg_conf)                               | `enum`     | C     | 配置模板：oltp,olap,crit,tiny。默认为 `oltp.yml`                   |
| [`pg_max_conn`](#pg_max_conn)                       | `int`      | C     | postgres 最大连接数，`auto` 将使用推荐值                   |
| [`pg_shared_buffer_ratio`](#pg_shared_buffer_ratio) | `float`    | C     | postgres 共享缓冲区内存比例，默认为 0.25，0.1~0.4                 |
| [`pg_rto`](#pg_rto)                                 | `int`      | C     | 恢复时间目标（秒），默认为 `30s`                          |

由于参数太多，为了保持文档的实用性，我将创建一个简化版本，重点突出最重要的部分。让我继续完成其他文件的翻译：